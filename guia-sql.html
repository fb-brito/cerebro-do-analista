<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guia Rápido de SQL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body class="antialiased">
    <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md shadow-sm">
        <div id="main-nav" class="container mx-auto px-6 py-3">
             <!-- A navegação será injetada pelo JS -->
        </div>
    </header>

    <main class="container mx-auto p-4 md:p-8">
        <section class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-black dark-accent-color mb-4">Guia Rápido de SQL</h1>
            <p class="text-lg text-gray-600 max-w-3xl mx-auto">Uma referência prática com os comandos e cláusulas mais importantes para análise de dados.</p>
        </section>

        <div id="sql-guide-container" class="max-w-4xl mx-auto card p-6 md:p-8">
            <!-- O conteúdo do guia SQL será injetado aqui -->
        </div>
        
        <div id="copy-notification" class="copy-notification">
            Comando copiado!
        </div>
    </main>

    <script src="navigation.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const sqlGuideData = [
                { 
                    category: 'Seleção e Filtragem',
                    commands: [
                        { title: 'SELECT / FROM / WHERE', explanation: 'A estrutura mais fundamental. Seleciona colunas específicas de uma tabela, aplicando filtros para retornar apenas as linhas que atendem a uma condição.', code: "SELECT nome_cliente, valor_pedido\nFROM pedidos\nWHERE status = 'Concluído';" },
                        { title: 'ORDER BY', explanation: 'Ordena os resultados com base em uma ou mais colunas, de forma ascendente (ASC) ou descendente (DESC).', code: "SELECT produto, vendas\nFROM relatorio_vendas\nORDER BY vendas DESC;" },
                        { title: 'DISTINCT', explanation: 'Retorna apenas os valores únicos de uma coluna, eliminando duplicatas.', code: "SELECT DISTINCT pais\nFROM clientes;" }
                    ]
                },
                {
                    category: 'Agregação e Agrupamento',
                    commands: [
                        { title: 'GROUP BY', explanation: 'Agrupa linhas que têm os mesmos valores em colunas especificadas em um registro de resumo. É quase sempre usado com funções de agregação.', code: "SELECT categoria, AVG(preco)\nFROM produtos\nGROUP BY categoria;" },
                        { title: 'COUNT / SUM / AVG', explanation: 'Funções de agregação que contam o número de linhas (COUNT), somam os valores (SUM) ou calculam a média (AVG) de uma coluna.', code: "SELECT COUNT(id_pedido) AS total_pedidos,\n       SUM(valor_total) AS faturamento_total\nFROM vendas;" },
                        { title: 'HAVING', explanation: 'Filtra os resultados de um agrupamento. Enquanto o WHERE filtra linhas antes da agregação, o HAVING filtra grupos depois da agregação.', code: "SELECT pais, COUNT(*)\nFROM clientes\nGROUP BY pais\nHAVING COUNT(*) > 10;" }
                    ]
                },
                {
                    category: 'Junção de Tabelas (JOINs)',
                    commands: [
                        { title: 'INNER JOIN', explanation: 'Retorna apenas os registros que têm valores correspondentes em ambas as tabelas que estão sendo unidas.', code: "SELECT pedidos.id, clientes.nome\nFROM pedidos\nINNER JOIN clientes ON pedidos.id_cliente = clientes.id;" },
                        { title: 'LEFT JOIN', explanation: 'Retorna todos os registros da tabela da esquerda (a primeira mencionada) e os registros correspondentes da tabela da direita. Se não houver correspondência, o resultado é NULL no lado direito.', code: "SELECT clientes.nome, pedidos.id\nFROM clientes\nLEFT JOIN pedidos ON clientes.id = pedidos.id_cliente;" }
                    ]
                },
                {
                    category: 'Funções Avançadas e Condicionais',
                    commands: [
                        { title: 'CASE WHEN', explanation: 'Permite criar uma lógica condicional diretamente na sua consulta, retornando valores diferentes com base nas condições especificadas. Similar a um if-then-else.', code: "SELECT nome_produto,\n  CASE\n    WHEN preco < 50 THEN 'Barato'\n    WHEN preco BETWEEN 50 AND 150 THEN 'Médio'\n    ELSE 'Caro'\n  END AS faixa_preco\nFROM produtos;" },
                        { title: 'Window Functions (Ex: ROW_NUMBER)', explanation: 'Executa um cálculo sobre um conjunto de linhas que estão relacionadas à linha atual. Útil para criar rankings, calcular somas acumuladas, etc., sem colapsar as linhas como um GROUP BY.', code: "SELECT nome, setor, salario,\n  ROW_NUMBER() OVER(PARTITION BY setor ORDER BY salario DESC) as ranking_salario_setor\nFROM funcionarios;" }
                    ]
                }
            ];

            const container = document.getElementById('sql-guide-container');
            const notification = document.getElementById('copy-notification');

            sqlGuideData.forEach(section => {
                const sectionTitle = document.createElement('h3');
                sectionTitle.className = 'text-2xl font-bold accent-color mb-6 mt-8 first:mt-0';
                sectionTitle.textContent = section.category;
                container.appendChild(sectionTitle);

                section.commands.forEach(item => {
                    const accordionItem = document.createElement('div');
                    accordionItem.className = 'border-b border-gray-200';
                    accordionItem.innerHTML = `
                        <button class="w-full text-left p-4 font-semibold dark-accent-color focus:outline-none flex justify-between items-center">
                            <span>${item.title}</span>
                            <span class="accordion-icon transform transition-transform duration-300 text-2xl font-light">+</span>
                        </button>
                        <div class="accordion-content px-4 text-gray-700">
                            <p class="py-4">${item.explanation}</p>
                            <div class="code-block mb-4">
                                <button class="copy-icon" title="Copiar comando"><i class="far fa-copy"></i></button>
                                <pre><code>${item.code.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</code></pre>
                            </div>
                        </div>
                    `;
                    container.appendChild(accordionItem);

                    const button = accordionItem.querySelector('button');
                    const content = accordionItem.querySelector('.accordion-content');
                    const icon = button.querySelector('.accordion-icon');
                    
                    button.addEventListener('click', () => {
                        const isOpen = content.style.maxHeight && content.style.maxHeight !== '0px';
                        
                        if (!isOpen) {
                            content.style.maxHeight = content.scrollHeight + "px";
                            icon.textContent = '−';
                        } else {
                            content.style.maxHeight = '0px';
                            icon.textContent = '+';
                        }
                    });

                    accordionItem.querySelector('.copy-icon').addEventListener('click', (e) => {
                        e.stopPropagation();
                        navigator.clipboard.writeText(item.code).then(() => {
                            notification.classList.add('show');
                            setTimeout(() => notification.classList.remove('show'), 2000);
                        });
                    });
                });
            });
        });
    </script>
</body>
</html>
